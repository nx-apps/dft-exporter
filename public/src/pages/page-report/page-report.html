<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../layout/shared-styles.html">
<link rel="import" href="../../nylon-behavior.html">
<link rel="import" href="../components/page-header.html">
<link rel="import" href="../components/page-panel.html">
<link rel="import" href="../../../bower_components/vaadin-combo-box/vaadin-combo-box.html">
<link rel="import" href="../components/nylon-panel-right.html">
<link rel="import" href="../../../bower_components/paper-button/paper-button.html">
<link rel="import" href="./components/report-list.html">
<link rel="import" href="./components/report-manage.html">
<link rel="import" href="../../redux-behavior.html">

<dom-module id="page-report">
    <template>
        <style include="shared-styles">
            #tabmain1:checked~#contentmain1,
            #tabmain2:checked~#contentmain2 {
                display: block;
            }
            /*---------------------------------*/
            /*paper-fab{
                position: fixed;
                bottom: 20px;
                right: 20px;
                --paper-fab-background: #337ab7;
            }*/
        </style>

        <page-header label="รายงานการส่งออกข้าว">

            <paper-button class="gl-btn-primary" on-tap="openPanel" raised>
                <iron-icon icon="add"></iron-icon>
                นำเข้ารายงาน
            </paper-button>

        </page-header>
        <page-panel>
            <div class="row around-xs">
                <div class="col-xs-3">
                    <div class="box">
                        <vaadin-combo-box label="เดือน" items="[[month]]" item-label-path="name" item-value-path="id" value="{{data.month}}"></vaadin-combo-box>
                    </div>
                </div>
                <div class="col-xs-3">
                    <div class="box">
                        <vaadin-combo-box label="ปี" items="[[year]]" value="{{data.selectYear}}"></vaadin-combo-box>
                    </div>
                </div>
                <div class="col-xs-3">
                    <div class="box">
                        <vaadin-combo-box label="ประเภทข้าว" items="[[typeRice]]" item-label-path="type_rice_name_th" item-value-path="id" value="{{data.type_rice_id}}"></vaadin-combo-box>
                    </div>
                </div>
            </div>
            <div class="row center-xs">
                <div class="col-xs-6">
                    <div class="box section">
                        <paper-button class="gl-btn-primary" on-tap="searchData" style="width:100%" raised>
                            <iron-icon icon="search"></iron-icon>
                            ค้นหา
                        </paper-button>
                    </div>
                </div>
            </div>
        </page-panel>

        <div class="section">
            <main>
                <input class="radio" id="tabmain1" type="radio" on-tap="checkQuota" name="tabs" value="true" checked>
                <label for="tabmain1">ในโควตา</label>

                <input class="radio" id="tabmain2" type="radio" on-tap="checkQuota" name="tabs" value="false">
                <label for="tabmain2">นอกโควตา</label>

                <section id="contentmain1">
                    <page-panel>
                        <report-list on-search="searchData" on-open-panel="openPanel"></report-list>
                        <!--<report-list2 data="{{dataListInQuota}}" on-data-select="getDataSelect"></report-list2>-->
                    </page-panel>
                </section>

                <section id="contentmain2">
                    <page-panel>
                        <report-list on-search="searchData" on-open-panel="openPanel"></report-list>
                        <!--<report-list2 data="{{dataListOutQuota}}" on-data-select="getDataSelect"></report-list2>-->
                    </page-panel>
                </section>
            </main>
        </div>

        <nylon-panel-right title="นำเข้ารายงานการส่งออกข้าวไปสหภาพยุโรป" width="90%">
            <report-manage on-search="searchData"></report-manage>
        </nylon-panel-right>

    </template>
    <script>
        Polymer({
            is: 'page-report',
            behaviors: [NylonBehavior, ReduxBehavior],
            observers:['setYear(data.selectYear)'],
            properties: {
                year: {
                    statePath: 'commonData.year'
                },
                typeRice: {
                    statePath: 'commonData.type_rice'
                },
                month: {
                    statePath: 'commonData.month'
                },
                data:{
                    type:Object,
                    value:{
                        month:'',
                        selectYear:'',
                        type_rice_id:''
                    }
                }
            },
            nylonPageActive: function () {
                this.dispatchAction('COMMON_DATA_GET_YEAR');
                // this.dispatchAction('COMMON_DATA_GET_TYPE_RICE');
                this.dispatchAction('COMMON_DATA_GET_COMPANY');
            },
            setYear:function(val){
                this.dispatchAction('COMMON_DATA_SET_YEAR',val)
            },
            searchData: function () {
                // console.log(this.data);
                this.dispatchAction('REPORT_GET_LIST', this.data);
            },
            checkQuota: function (e) {
                this.data.quota = e.target.value;
                if(this.data.month != '' && this.data.selectYear != '' && this.data.type_rice_id != ''){
                    // console.log('event',this.data);
                    this.dispatchAction('REPORT_GET_LIST', this.data);
                }
            },
            openPanel: function () {
                this.dispatchAction('REPORT_CELAR');
                this.$$('nylon-panel-right').open();
            }
        });
    </script>
</dom-module>