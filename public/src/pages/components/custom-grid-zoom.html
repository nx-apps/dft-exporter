<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../layout/shared-styles.html">
<link rel="import" href="./../../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="./../../../bower_components/web-animations-js/web-animations.min.html">

<dom-module id="custom-grid-zoom">
    <template>
        <style>
            div ::slotted([slot=grid]) {
                height: var(--grid-zoom-height);
            }

            [bg],[bg2]{
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                
            }

            [bg]{
                z-index: 1;
                opacity: 0.5;
                background-color: #000;
            }
            
            [bg2]{
                z-index: 1;
                padding: 2rem;
                box-sizing: border-box;
            }
            .base{
                position: relative;
            }

            .panel{
                position: absolute;
                top:0px;
                right:0;
                z-index: 1;
            }

           
        </style>


        <div id="gridBg" bg$="[[zoom]]" on-tap="change"></div>
        <div class="base">
            <div bg2$="[[zoom]]">
                <div class="panel">
                    <paper-icon-button icon="[[iconFullScreen]]" on-tap="change"></paper-icon-button>
                </div>
                <slot id="gridPanel" name="grid"></slot>
            </div>
        </div>
            
        
    </template>
    <script>
        Polymer({
            is:'custom-grid-zoom',
            properties:{
                zoom:{
                    type:Boolean,
                    value:false,
                    observer:'_changeZoom'
                },
                iconFullScreen:{
                    type:String,
                    value:'fullscreen'
                }
            },
            _changeZoom:function(val){
                if(val){
                    
                    this.customStyle['--grid-zoom-height'] = '100%';
                    this.iconFullScreen = "fullscreen-exit";
                }else{
                    console.log('end');
                    this.$.gridBg.animate(
                        [{opacity:0.5},{opacity:0}],
                        {duration:200,intertion:1}
                    )
                    this.customStyle['--grid-zoom-height'] = 'auto';
                    this.iconFullScreen = "fullscreen";
                }
                
                this.updateStyles();
            },
            change:function(){
                if(this.zoom){
                    this.$.gridBg.animate(
                        [{opacity:0.5},{opacity:0}],
                        {duration:200,intertion:1}
                    ).onfinish = ()=>{
                        this.zoom=false;
                    }

                    this.$.gridPanel.animate(
                        [{opacity:0.5},{opacity:0}],
                        {duration:200,intertion:1}
                    )
                    
                }else{
                    this.zoom=true;
                    this.$.gridBg.animate(
                        [{opacity:0},{opacity:0.5}],
                        {duration:200,intertion:1}
                    )
                    //console.log(this.$.gridPanel)
                    this.$.gridPanel.animate(
                        [{opacity:0},{opacity:0.5}],
                        {duration:200,intertion:1}
                    )
                    
                }
            }
            
        });
    </script>
</dom-module>