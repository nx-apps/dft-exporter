<link rel="import" href="../../../bower_components/vaadin-combo-box/vaadin-combo-box.html">
<link rel="import" href="../../layout/shared-styles.html">
<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../nylon-behavior.html">
<!--<link rel="import" href="../components/nylon-panel-right.html">-->
<link rel="import" href="../components/page-header.html">
<link rel="import" href="../components/page-panel.html">
<link rel="import" href="../../../bower_components/vaadin-date-picker/vaadin-date-picker.html">
<link rel="import" href="../../redux-behavior.html">
<link rel="import" href="../components/nylon-panel-right.html">

<link rel="import" href="./../components/format-number-behavior.html">

<link rel="import" href="./components/money-manage.html">
<!--<link rel="import" href="./../components/data-manage-behavior.html">-->
<link rel="import" href="./components/money-list.html">
<link rel="import" href="./components/money-print.html">

<dom-module id="page-money">
    <template>
        <style include="shared-styles">
            #subp1:checked~#subcontentp1,
            #subp2:checked~#subcontentp2 {
                display: block;
            }
            .textRight{
                text-align: right;
            }
        </style>
        <!--<page-header>
            <paper-button class="gl-btn-primary" on-tap="activeReports" raised>ออกรายงาน</paper-button>
        </page-header>-->

        <page-panel>
            <div class="row around-xs">
                <div class="col-xs-3">
                    <div class="box">
                        <vaadin-date-picker label="เริ่มวันที่" value="{{data.first_date}}"></vaadin-date-picker>
                    </div>
                </div>
                <div class="col-xs-3">
                    <div class="box">
                        <vaadin-date-picker label="ถึงวันที่" value="{{data.last_date}}"></vaadin-date-picker>
                    </div>
                </div>
            </div>

            <div class="row center-xs">
                <div class="col-xs-6">
                    <div class="box">
                        <paper-button class="gl-btn-primary" style="width:100%" on-tap="searchData" raised>
                            <iron-icon icon="search"></iron-icon>
                            ค้นหา
                        </paper-button>
                    </div>
                </div>
            </div>
        </page-panel>
        <nylon-panel-right title="จัดการ"> 
            <iron-pages selected="{{selectPage}}">
                 <div class="container">
                    <money-manage select="[[data]]"></money-manage>
                </div>
                <div class="container">
                    <money-print id="moneyPrint"></money-print>
                </div>
            </iron-pages>
        </nylon-panel-right>
        <div class="white-space"></div>
            <main>
                <input class="radio" id="subp1" type="radio" name="sub" value="true" checked>
                <label for="subp1">ใบเสร็จ</label>

                <input class="radio" id="subp2" type="radio" name="sub" value="false">
                <label for="subp2">ใบเสร็จที่ยกเลิก</label>

                <section id="subcontentp1">
                    <page-panel>
                        <div class="textRight">
                            <paper-button class="gl-btn-primary" on-tap="activeReports" raised >ออกรายงาน</paper-button>
                        </div>
                        <money-list data="[[list.noCancel]]" price="[[list.price]]" select="[[data]]"></money-list>
                    </page-panel>
                </section>
                <section id="subcontentp2">
                    <page-panel>
                        <div class="textRight">
                            <paper-button class="gl-btn-primary" on-tap="activeReports" raised >ออกรายงาน</paper-button>
                        </div>
                        <money-list data="[[list.Cancel]]" price="[[list.price]]" select="[[data]]"></money-list>
                    </page-panel>
                </section>
            </main>
        <!-- <div class="flex-end-justified" style="padding:10px;"> -->
            
        <!-- </div> -->
    </template>
    <script>
        Polymer({
            is: 'page-money',
            behaviors: [NylonBehavior,ReduxBehavior,FormatNumberBehavior],
            listeners:{
                'open-panel':'openPanel'
            },
            properties:{
                data:{
                    type:Object,
                    value:{}
                },
                list:{
                    statePath:'fee.printList'
                },
                selectPage:{
                    type:String,
                    value:''
                }
            },
            nylonPageActive: function () {
                // console.log('event');
                // 
                // this.dispatchAction('COMMON_DATA_GET_YEAR');
            },
            openPanel:function(e){
                if(e.detail.page == 1){
                    // console.log(e.detail.id)
                    this.$.moneyPrint.form.id = e.detail.id;
                }
                this.selectPage = e.detail.page;
                this.$$('nylon-panel-right').open();
            },
            searchData:function(){
                // console.log(this.date_first,this.date_last);
                
                this.dispatchAction('FEE_GET_PRINT_LIST',this.data)
                //  window.open('/api/payment/reports?frist_date='+this.get.first_date+'&last_date='+this.get.last_date,'_blank');
            },
            activeReports:function(){
                 window.open('/api/payment/reports?first_date='+this.data.first_date+'&last_date='+this.data.last_date+'&price='+this.formatNumber(this.list.price,'0,0'),'_blank');
            }
        });
    </script>
</dom-module>